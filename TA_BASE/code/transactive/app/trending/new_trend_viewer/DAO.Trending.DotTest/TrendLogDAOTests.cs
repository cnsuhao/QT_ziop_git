using DAO.Trending;
using Dottest.Framework;
using NUnit.Framework;
using System;
using Entity.Trending;

namespace DAO.Trending.DotTest
{
    [TestFixture()]
    public class TrendLogDAOTests
    {
        [TestFixtureSetUp]
        public void FixtureSetUp()
        {
            TestDBInit.openConn();
        }

        [TestCaseUnverified("Test case not verified")]
        [TestCaseAutogenerated]
        [TestAuthor("user")]
        [Test]
        [HashCode("+vutww", "/nzsdw")]
        public void TestGetInstance01()
        {
            TrendLogDAO trendLogDAO = TrendLogDAO.GetInstance();
        }

        [TestCaseUnverified("Test case not verified")]
        [TestCaseAutogenerated]
        [TestAuthor("user")]
        [Test]
        [HashCode("+zu1qw", "+vBuaw")]
        public void TestReleaseInstance01()
        {
            TrendLogDAO.ReleaseInstance();
        }

        [TestCaseUnverified("Test case not verified")]
        [TestCaseAutogenerated]
        [TestAuthor("user")]
        [Test]
        [HashCode("/aBADw", "+gSBdg")]
        public void TestTrendLogDAOConstructor01()
        {
            TrendLogDAO trendLogDAO = new TrendLogDAO();
        }

        [Test]
        public void TestGetHistDPLogList()
        {
            EtyHistDataPoint histDP = new EtyHistDataPoint();
            histDP.DPName = "DT17.COM.CBN.RF2.diiRF-AlarmNormal.Value";
            histDP.DPServer = TestDBInit.OPCSERVER_NAME; //"TransActiveDataSource"
            histDP.DPHost = TestDBInit.HOST_NAME;
            histDP.DPStartDateTime = new DateTime(2013, 1, 10);
            histDP.DPEndDateTime = new DateTime(2013, 1, 12);

            DateTime startTime = new DateTime(2012, 1, 10, 1, 1, 1);
            DateTime endTime = new DateTime(2012, 1, 12, 23, 59, 59);

            TrendLogDAO.GetInstance().GetHistDPLogList(histDP, startTime, endTime);
        }

        [Test]
        public void TestGetHistDPLogList02()
        {
            //exception:
            EtyHistDataPoint histDP = new EtyHistDataPoint();
            histDP.DPName = "DT17.COM.CBN.RF2.diiRF-AlarmNormal.Value";
            histDP.DPServer = TestDBInit.OPCSERVER_NAME; //"TransActiveDataSource"
            histDP.DPHost = TestDBInit.HOST_NAME;
            histDP.DPStartDateTime = new DateTime(2013, 1, 10);
            histDP.DPEndDateTime = new DateTime(2013, 1, 12);

            DateTime startTime = new DateTime(2012, 1, 10, 1, 1, 1);
            DateTime endTime = new DateTime(2012, 1, 12, 23, 59, 59);

            TrendLogDAO.GetInstance().GetHistDPLogList(histDP, startTime, endTime);
        }

        [Test]
        public void InsertTrendViewerLog()
        {
            EtyTrendLog etyTrendLog = new EtyTrendLog();
            etyTrendLog.Data_PT_Host = TestDBInit.HOST_NAME;
            etyTrendLog.Data_PT_Server = TestDBInit.OPCSERVER_NAME; //"TransActiveDataSource"
            etyTrendLog.Data_PT_Name = "unitTest_Log1";
            etyTrendLog.Data_PT_Value = 2;
            etyTrendLog.Data_PT_Time = DateTime.Now;

            TrendLogDAO.GetInstance().InsertTrendViewerLog(etyTrendLog);
        }
    }

}
