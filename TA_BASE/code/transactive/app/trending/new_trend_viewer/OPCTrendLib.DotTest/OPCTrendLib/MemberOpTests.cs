using Dottest.Framework;
using Dottest.Framework.RecordState;
using NUnit.Framework;
using OPCTrendLib;

namespace DotTest.OPCTrendLib
{
    public class MytestClass
    {
        public int m_number = 1;
        public string GetName()
        {
            return "testing";
        }

        public string Name
        {
            get;
            set;
        }

        public void SetName(string name)
        {
            this.Name = name;
        }

        public static string GetStaticName()
        {
            return "Testingstatic";
        }
    }

    [TestFixture()]
    public class MemberOpTests
    {
        [TestCaseUnverified("Test case not verified")]
        [TestCaseAutogenerated]
        [TestAuthor("user")]
        [Test]
        public void TestEval01()
        {
            MemberOp memberOP = new MemberOp();
            memberOP.ToString();
            Evaluator evalutor = new Evaluator();
            Result[] argArray = new Result[2];
            MytestClass myclass = new MytestClass();
            Result res1 = new Result(myclass);
            Result res2 = new Result("GetName");
            argArray[0]=res1;
            argArray[1] = res2;
            Accessor memberAccessor = ReflectionAccessor.Wrap(memberOP);
            memberAccessor.SetField("_isFunction",true);
            //Test Procedure Call
            Result res = memberOP.Eval(evalutor,argArray);
            //Post Condition Check
            Assert.AreEqual(myclass.GetName(), res.Value);           
        }

        [TestCaseUnverified("Test case not verified")]
        [TestCaseAutogenerated]
        [TestAuthor("user")]
        [Test]
        public void TestEval02()
        {
            MemberOp memberOP = new MemberOp();           
            Evaluator evalutor = new Evaluator();
            Result[] argArray = new Result[2];
            MytestClass myclass = new MytestClass();
            Result res1 = new Result(typeof(MytestClass));
            Result res2 = new Result("GetStaticName");
            argArray[0] = res1;
            argArray[1] = res2;
            memberOP.IsFunction = true;
            //Test Procedure Call
            Result res = memberOP.Eval(evalutor, argArray);
            //Post Condition Check
            Assert.AreEqual(MytestClass.GetStaticName(), res.Value);
        }

        [TestCaseUnverified("Test case not verified")]
        [TestCaseAutogenerated]
        [TestAuthor("user")]
        [Test]
        public void TestEval03()
        {
            MemberOp memberOP = new MemberOp();            
            Evaluator evalutor = new Evaluator();
            Result[] argArray = new Result[3];
            MytestClass myclass = new MytestClass();
            Result res1 = new Result(myclass);
            Result res2 = new Result("SetName");
            Result res3 = new Result("SetNameCalled");
            argArray[0] = res1;
            argArray[1] = res2;
            argArray[2] = res3;
            Accessor memberAccessor = ReflectionAccessor.Wrap(memberOP);
            memberAccessor.SetField("_isFunction", true);
            memberOP.ToString();
            //Test Procedure Call
            Result res = memberOP.Eval(evalutor, argArray);
            //Post Condition Check
            Assert.AreEqual(null, res.Value);
        }

        [ExpectedException(typeof(System.ArgumentException))]
        [TestCaseUnverified("Test case not verified")]
        [TestCaseAutogenerated]
        [TestAuthor("user")]
        [Test]
        public void TestErr_Eval01()
        {
            MemberOp memberOP = new MemberOp();
            Evaluator evalutor = new Evaluator();
            Result[] argArray = new Result[1];
            MytestClass myclass = new MytestClass();
            Result res1 = new Result(myclass);
            argArray[0] = res1;
            Accessor memberAccessor = ReflectionAccessor.Wrap(memberOP);
            memberAccessor.SetField("_isFunction", true);
            //Test Procedure Call
            Result res = memberOP.Eval(evalutor, argArray);
            //Post Condition Check
            
        }

        [ExpectedException(typeof(System.ArgumentException))]
        [TestCaseUnverified("Test case not verified")]
        [TestCaseAutogenerated]
        [TestAuthor("user")]
        [Test]
        public void TestErr_Eval02()
        {
            MemberOp memberOP = new MemberOp();
            Evaluator evalutor = new Evaluator();
            Result[] argArray = new Result[2];         
            Result res1 = new Result(typeof(MytestClass),null);
            Result res2 = new Result("GetName");
            argArray[0] = res1;
            argArray[1] = res2;
            Accessor memberAccessor = ReflectionAccessor.Wrap(memberOP);
            memberAccessor.SetField("_isFunction", true);
            //Test Procedure Call
            Result res = memberOP.Eval(evalutor, argArray);
            //Post Condition Check
            
        }

        [ExpectedException(typeof(System.ArgumentException))]
        [TestCaseUnverified("Test case not verified")]
        [TestCaseAutogenerated]
        [TestAuthor("user")]
        [Test]
        public void TestErr_Eval03()
        {
            MemberOp memberOP = new MemberOp();
            Evaluator evalutor = new Evaluator();
            Result[] argArray = new Result[2];          
            Result res1 = null;
            Result res2 = new Result("GetName");
            argArray[0] = res1;
            argArray[1] = res2;
            Accessor memberAccessor = ReflectionAccessor.Wrap(memberOP);
            memberAccessor.SetField("_isFunction", true);
            //Test Procedure Call
            Result res = memberOP.Eval(evalutor, argArray);
            //Post Condition Check
            
        }

        [TestCaseUnverified("Test case not verified")]
        [TestCaseAutogenerated]
        [TestAuthor("user")]
        [Test]
        public void TestEvalMember01()
        {
            MemberOp memberOP = new MemberOp();            
            Evaluator evalutor = new Evaluator();
            Result[] argArray = new Result[2];
            MytestClass myclass = new MytestClass();
            Result res1 = new Result(myclass);
            Result res2 = new Result("Name");
            argArray[0] = res1;
            argArray[1] = res2;
            //Test Procedure Call
            Result res = memberOP.Eval(evalutor, argArray);
            //Post Condition Check
            Assert.AreEqual(myclass.Name, res.Value);
        }

        [TestCaseUnverified("Test case not verified")]
        [TestCaseAutogenerated]
        [TestAuthor("user")]
        [Test]
        public void TestEvalField01()
        {
            MemberOp memberOP = new MemberOp();
            Evaluator evalutor = new Evaluator();
            Result[] argArray = new Result[2];
            MytestClass myclass = new MytestClass();
            Result res1 = new Result(myclass);
            Result res2 = new Result("m_number");
            argArray[0] = res1;
            argArray[1] = res2;
            //Test Procedure Call
            Result res = memberOP.Eval(evalutor, argArray);
            //Post Condition Check
            Assert.AreEqual(myclass.m_number, res.Value);
        }

        [ExpectedException(typeof(System.ArgumentException))]
        [TestCaseUnverified("Test case not verified")]
        [TestCaseAutogenerated]
        [TestAuthor("user")]
        [Test]
        public void TestEvalStaticField01()
        {
            MemberOp memberOP = new MemberOp();
            Evaluator evalutor = new Evaluator();
            Result[] argArray = new Result[2];            
            Result res1 = new Result(typeof(MytestClass));
            Result res2 = new Result("m_Staticnumnr");
            argArray[0] = res1;
            argArray[1] = res2;
            //Test Procedure Call
            Result res = memberOP.Eval(evalutor, argArray);
            //Post Condition Check            
        }

        [ExpectedException(typeof(System.ArgumentException))]
        [TestCaseUnverified("Test case not verified")]
        [TestCaseAutogenerated]
        [TestAuthor("user")]
        [Test]
        public void TestErr_EvalStaticField01()
        {
            MemberOp memberOP = new MemberOp();
            Evaluator evalutor = new Evaluator();
            Result[] argArray = new Result[0];
            Result res1 = new Result(typeof(MytestClass));
            Result res2 = new Result("m_Staticnumnr");
            //argArray[0] = res1;
            //argArray[1] = res2;
            //Test Procedure Call
            Result res = memberOP.Eval(evalutor, argArray);
            //Post Condition Check            
        }


        
        [TestCaseUnverified("Test case not verified")]
        [TestCaseAutogenerated]
        [TestAuthor("user")]
        [Test]
        public void TestErr_EvalStaticField02()
        {
            MemberOp memberOP = new MemberOp();
            memberOP.ToString();
            Evaluator evalutor = new Evaluator();
            Result[] argArray = new Result[1];
            Result res1 = new Result(typeof(MytestClass));
            Result res2 = new Result("m_Staticnumnr");
            argArray[0] = res1;
            //argArray[1] = res2;
            //Test Procedure Call
            Result res = memberOP.Eval(evalutor, argArray);
            //Post Condition Check            
        }

        [ExpectedException(typeof(System.ArgumentException))]
        [TestCaseUnverified("Test case not verified")]
        [TestCaseAutogenerated]
        [TestAuthor("user")]
        [Test]
        public void TestErr_EvalStaticField03()
        {
            MemberOp memberOP = new MemberOp();
            Evaluator evalutor = new Evaluator();
            Result[] argArray = new Result[2];
            Result res1 = new Result(typeof(MytestClass));
            Result res2 = new Result(typeof(string),null);
            argArray[0] = res1;
            argArray[1] = res2;
            //Test Procedure Call
            Result res = memberOP.Eval(evalutor, argArray);
            //Post Condition Check            
        }


        [ExpectedException(typeof(System.ArgumentException))]
        [TestCaseUnverified("Test case not verified")]
        [TestCaseAutogenerated]
        [TestAuthor("user")]
        [Test]
        public void TestErr_EvalStaticField04()
        {
            MemberOp memberOP = new MemberOp();
            Evaluator evalutor = new Evaluator();
            Result[] argArray = new Result[2];
            Result res1 = null;
            Result res2 = new Result(typeof(string), "GetName");
            argArray[0] = res1;
            argArray[1] = res2;
            //Test Procedure Call
            Result res = memberOP.Eval(evalutor, argArray);
            //Post Condition Check            
        }

        [ExpectedException(typeof(System.ArgumentException))]
        [TestCaseUnverified("Test case not verified")]
        [TestCaseAutogenerated]
        [TestAuthor("user")]
        [Test]
        public void TestErr_EvalStaticField05()
        {
            MemberOp memberOP = new MemberOp();
            Evaluator evalutor = new Evaluator();
            Result[] argArray = new Result[2];
            Result res1 = new Result(typeof(MytestClass), null); 
            Result res2 = new Result(typeof(string), "GetName");
            argArray[0] = res1;
            argArray[1] = res2;
            //Test Procedure Call
            Result res = memberOP.Eval(evalutor, argArray);
            //Post Condition Check            
        }


        [TestCaseUnverified("Test case not verified")]
        [TestCaseAutogenerated]
        [TestAuthor("user")]
        [Test]
        public void TestGetPriority01()
        {
            MemberOp memberOP = new MemberOp();           
            //Test Procedure Call
            OperatorPriority priority = memberOP.Priority;
            //Post Condition Check            
        }


    }
}
